<head>
  <title>Blacklabel</title>
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
</head>

<body>
  {{#if currentUser}}
    {{> top}}
  {{else}}
    {{> login}}
  {{/if}}
</body>

<template name="login">
  <div class="loginForm">
    <h1>Hello</h1>
    <p>This is a private Blacklabel server. You must now present your
      bona fides.</p>
    {{#if loggingIn}}
      Logging in ...
    {{else}}
      {{#if error}}
        <div class="error">{{error}}</div>
      {{/if}}
    {{/if}}
    <label>Username: <input type="text" class="username"></label><br>
    <label>Password: <input type="password" class="password"></label><br>
    <input type="button" class="login" value="Enter server">

    <br><br><br>
    To create an account, open the console and type something like:<br>
    <pre>Accounts.createUser({username: "you", password: "kitten"})</pre>

  </div>
</template>

<template name="top">
  <div class="container-fluid main-container">
    <div class="row-fluid main-row">
      <div class="span2 main-span">
        {{> leftPane }}
      </div>

      <div class="span5 main-span">
        {{#if activityIs "chat"}}
          {{> chatPane }}
        {{/if}}
        {{#if activityIs "library"}}
          {{> libraryPane }}
        {{/if}}
        {{#if activityIs "account"}}
          {{> accountPane }}
        {{/if}}
      </div>

      <div class="span5 main-span">
        {{> rightPane }}
      </div>
    </div>
  </div>
</template>

<template name="leftPane">
  <div class="left-outer">
    <div class="left-inner">
      <div class="left-top">

        <img src="/blacklabel.png">
        <ul class="nav nav-pills nav-stacked">
          {{#each activities}}
          <li class="activity {{maybeActive}}">
            <a><i class="fa {{icon}} fa-2x fa-fw"></i>{{name}}</a>
          </li>
          {{/each}}
        </ul>

      </div>
      <div class="left-bottom">
        {{currentUser.username}}<br>
        <a class="logout">Log out</a>
      </div>
    </div>
  </div>
</template>

<template name="chatPane">
  <div class="chat-outer">
    <div class="chat-inner">
      <div class="chat-view">
        {{#each allEvents}}
          <div class="chat-message">
            {{username}}: {{message}}
          </div>
          {{/each}}
      </div>
      <div class="chat-entry">
        <textarea></textarea>
      </div>
    </div>
  </div>
</template>

<template name="accountPane">
  <h1>Your Account</h1>
  <br><br>
  I'll find something to put here.
  <br><br>

  <h3>Dropbox</h3>
  {{#if haveDropbox}}
    <p>Currently linked Dropbox: <b>{{linkedDropboxName}}</b></p>
    <input type="button" class="unlinkDropbox" value="Unlink">
  {{else}}
    <input type="button" class="linkDropbox" value="Link your Dropbox">
  {{/if}}
</template>

<template name="libraryPane">
  <div class="library">
    <h1>Ah. The Library.</h1>
    <table class="table table-condensed">
      <thead>
        <tr>
          <th>Title</th>
          <th>Artist</th>
          <th>Album</th>
          <th>Track</th>
        </tr>
      </thead>
      {{#each dropboxes}}
      {{#each files}}
        {{#if hasMetadata}}
          <tr class="song">
            <td>{{metadata.title}}</td>
            <td>{{metadata.artist}}</td>
            <td>{{metadata.album}}</td>
            <td>{{metadata.track}}</td>
          </tr>
        {{/if}}
      {{/each}}
      {{/each}}
    </table>

    {{#if anyWithoutMetadata}}
      <h3>Files lacking tags</h3>

      <table class="table table-condensed">
      {{#each filesWithoutMetadata}}
        <tr class="song">
          <td>{{path}}</td>
        </tr>
      {{/each}}
      </table>
    {{/if}}

  </div>
</template>

<template name="rightPane">
  <div class="queue">
    <h1>Queue</h1>
    <table class="table table-condensed" tabindex="0">
      <thead>
        <tr>
          <th>%</th>
          <th>Who</th>
          <th>Song</th>
        </tr>
      </thead>
      {{#each queuedSongs}}
        {{#unless isInPast}}
        <tr class="entry {{maybeSelected}} {{maybePlaying}}">
          <td>{{percentLoaded}}</td>
          <td>{{username}}</td>
          {{#with file}}
            {{#if hasMetadata}}
              <td>{{metadata.title}} &mdash; {{metadata.artist}}</td>
            {{else}}
              <td>{{path}}</td>
            {{/if}}
          {{/with}}
        </tr>
        {{/unless}}
      {{/each}}
    </table>
  </div>
</template>

